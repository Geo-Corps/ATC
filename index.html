<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="css/styles.css">
    <style>    
    </style>
  </head>
  <body>
    <h3>Appalachian Trail</h3>
    <!--The div element for the map -->
    <div id="map"></div>
    <script>
// Initialize and add the map
    function initMap() {
        
        var hq = {lat: 36.6337, lng: -81.7837};
        // The map, centered at Conservancy HQ in Damascus, VA.
        var map = new google.maps.Map(
          document.getElementById('map'), {zoom: 4, center: hq});

        // Set up empty data layers for data sources
        var atCentLineLayer = new google.maps.Data();
        var atSheltersLayer = new google.maps.Data();
        var atParkingLayer = new google.maps.Data();
        
        // Set geojson to full URL to be able to load the layer locally, due to CORS error
        var atCentLineSrc = 'https://geo-corps.github.io/ATC/data/at_cent_small.geojson'
        var atSheltersSrc = 'https://geo-corps.github.io/ATC/data/at_shelters.geojson'
        var atParkingSrc = 'https://geo-corps.github.io/ATC/data/at_parking.geojson'
        
        // Load all layers and style rules
        atCentLineLayer.loadGeoJson(atCentLineSrc);
        atCentLineLayer.setStyle({
          fillColor: 'green',
          strokeColor: 'green',
          strokeWeight: 3
        });
        
        
        var atShelterIconStyle = {
            url: 'https://geo-corps.github.io/ATC/data/icons/roofing-contractor.svg',
            scaledSize: new google.maps.Size(20, 20)
        }
        
        atSheltersLayer.loadGeoJson(atSheltersSrc);
        atSheltersLayer.setStyle({
          icon: atShelterIconStyle
        });
        
        var atParkingIconStyle = {
            url: 'https://geo-corps.github.io/ATC/data/icons/parking.svg',
            scaledSize: new google.maps.Size(20, 20)
        }
                
        atParkingLayer.loadGeoJson(atParkingSrc);
        atParkingLayer.setStyle({
          icon: atParkingIconStyle
        });
        
        // Add Layers to Map
        atCentLineLayer.setMap(map);
        atSheltersLayer.setMap(map);
        atParkingLayer.setMap(map);

    };

    </script>
    <!--Load APIs and execute early functions -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
    function styleMap() {
        $.getJSON('https://geo-corps.github.io/ATC/basemap-style.json', function(data) { 
        stylesATC = data;
        console.log('h')
        });
    };
    // Run styleMap function to load in base-map style file before map loads
    styleMap();
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8k09vVP7UOyx1IxMo-zoqFRcRTUo-vCw&callback=initMap">
    </script>
  </body>
</html>